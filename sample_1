import pandas as pd
import nltk
from nltk.corpus import words
import re

# Download nltk words corpus (only needed once)
nltk.download('words')
english_words = set(words.words())  # Set for faster lookup

# Read the Excel file
df = pd.read_excel('your_file.xlsx')

# Function to split based on dictionary words
def split_using_dict(value):
    result = ""
    temp_word = ""

    for char in value:
        temp_word += char
        # If the temp_word is valid, add it to the result
        if temp_word.lower() in english_words or temp_word in ['O2']:
            result += temp_word + " "
            temp_word = ""

    # Add remaining part if not already processed
    if temp_word:
        result += temp_word
    
    return result.strip()

# Apply the function to the column you want to format
df['formatted_column'] = df['your_column_name'].apply(lambda x: split_using_dict(x) if isinstance(x, str) else x)

# Save the updated dataframe to a new Excel file
df.to_excel('formatted_file.xlsx', index=False)
