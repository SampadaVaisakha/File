import pandas as pd
import nltk
from wordsegment import load, segment
from nltk.corpus import words

nltk.download('words')
load()

words_lst = set(words.words())
custom_known_words = {'savings', 'purchased', 'ind', 'terms', 'dates','user'}
words_lst.update(custom_known_words)

def further_split(word):
    if word.lower() in words_lst:
        return word

    for i in range(1, len(word)):
        part1, part2 = word[:i], word[i:]
        if part1.lower() in words_lst and part2.lower() in words_lst:
            return f'{part1} {part2}'
    
    return word

def split_combined(text):
    if '_' in text:
        return text
    
    segmented = segment(text)
    refined_segment = [further_split(word) for word in segmented]
    
    return ' '.join(refined_segment).upper()

def process_and_learn(text):
    processed_text = split_combined(text)
    for word in processed_text.split():
        if word.lower() not in words_lst:
            words_lst.add(word.lower())
    return processed_text

df = pd.read_excel(r"C:\Users\tejas\Downloads\sample.xlsx")
df.insert(1, 'Processed', df['input_column'].apply(lambda x: process_and_learn(x)))

df.tail(60)
