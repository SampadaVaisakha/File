import pandas as pd
import re

# Function to insert spaces correctly
def insert_spaces(word):
    # This regex pattern looks for capital letters and inserts spaces before each capital letter
    return re.sub(r'([a-z])([A-Z])', r'\1 \2', word).title()

# Function to process the Excel file
def process_excel(input_file, output_file):
    # Read the Excel file
    df = pd.read_excel(input_file, engine='openpyxl')
    
    # Assuming the column with concatenated values is named 'ColumnA', you can change it if needed
    if 'ColumnA' not in df.columns:
        print("ColumnA not found in the Excel file.")
        return
    
    # Apply the space-insertion function to the 'ColumnA'
    df['ColumnB'] = df['ColumnA'].apply(insert_spaces)
    
    # Save the updated DataFrame to a new Excel file
    df.to_excel(output_file, index=False, engine='openpyxl')

# Example usage
input_file = 'input_file.xlsx'  # Replace with your actual file path
output_file = 'output_file.xlsx'  # The file to save the results
process_excel(input_file, output_file)

print("Processing complete! Results saved to:", output_file)
